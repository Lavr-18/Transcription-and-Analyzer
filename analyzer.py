import os
import json
import re
import time
from openai import OpenAI
from dotenv import load_dotenv
from datetime import datetime
from pathlib import Path
from typing import Dict, Any

# –ü–æ–ø—ã—Ç–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ retailcrm_integration
try:
    from retailcrm_integration import get_manager_name_from_crm, get_order_link_by_phone, \
        get_order_items_status
except ImportError:
    print(
        "–í–ù–ò–ú–ê–ù–ò–ï: –ú–æ–¥—É–ª—å retailcrm_integration –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω.")


    # –ó–∞–≥–ª—É—à–∫–∏, —á—Ç–æ–±—ã –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
    def get_manager_name_from_crm(phone_number: str) -> str:
        print("  ‚ö†Ô∏è –ó–∞–≥–ª—É—à–∫–∞: get_manager_name_from_crm –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞. –í–æ–∑–≤—Ä–∞—â–∞–µ–º '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'.")
        return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"


    def get_order_link_by_phone(phone_number: str) -> str:
        print("  ‚ö†Ô∏è –ó–∞–≥–ª—É—à–∫–∞: get_order_link_by_phone –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞. –í–æ–∑–≤—Ä–∞—â–∞–µ–º ''.")
        return ""


    # –ó–ê–ì–õ–£–®–ö–ê –î–õ–Ø –ù–û–í–û–ô –§–£–ù–ö–¶–ò–ò
    def get_order_items_status(phone_number: str) -> Dict[str, bool]:
        print("  ‚ö†Ô∏è –ó–∞–≥–ª—É—à–∫–∞: get_order_items_status –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞. –í–æ–∑–≤—Ä–∞—â–∞–µ–º 'False, False'.")
        return {'has_plant': False, 'has_cachepot': False}

load_dotenv()
openai_api_key = os.getenv("OPENAI_API_KEY")
client = OpenAI(api_key=openai_api_key)

# –û–ë–ù–û–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π 'goal_clarified'
CRITERIA = [
    "—É–ª—ã–±–∫–∞_–≤_–≥–æ–ª–æ—Å–µ",
    "—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ_–∫–æ–Ω—Ç–∞–∫—Ç–∞",
    "–∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è",
    "–≤—ã—è–≤–ª–µ–Ω–∏–µ_–ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏",
    "goal_clarified",  # –ù–û–í–´–ô –ö–†–ò–¢–ï–†–ò–ô: –£—Ç–æ—á–Ω–∏–ª –ª–∏ —Ü–µ–ª—å –ø–æ–∫—É–ø–∫–∏
    "–ø–æ—Å–ª–µ–¥—É—é—â–∏–π_—É—Ç–æ—á–Ω—è—é—â–∏–π",
    "–ø–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ",
    "–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏_–ø–æ–∑–∏—Ü–∏–π",
    "–≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ",
    "–æ—Ç—Ä–∞–±–æ—Ç–∫–∞_–≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è",
    "–¥–æ–∫–æ–º–ø–ª–µ–∫—Ç",
    "–¥–æ–ø—Ä–æ–¥–∞–∂–∞",
    "—Å–æ—Å—Ç–∞–≤_–∏_—Å—É–º–º–∞",
    "—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ_–¥–µ—Ç–∞–ª–µ–π",
    "–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞"
]

# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏–º–µ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
ALLOWED_MANAGERS = [
    "–ê–Ω–∞—Å—Ç–∞—Å–∏—è",
    "–í–µ—Ä–∞",
    "–ê–º–∞–ª–∏—è",
    "–ï–≤–≥–µ–Ω–∏—è",
    "–ê–Ω—Ç–æ–Ω",
    "–ê–Ω–≥–µ–ª–∏–Ω–∞",
    "–í–∏–∫—Ç–æ—Ä–∏—è",
    "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",
    "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞",
    "–ê–ª–º–∞–∑",
    "–ö—Å–µ–Ω–∏—è",
]

# –ù–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–≤–æ–Ω–∫–æ–≤
CALL_CATEGORIES = [
    "–ó–∞–∫–∞–∑",  # –¶–µ–ª–µ–≤–æ–π –∑–≤–æ–Ω–æ–∫ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º/–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º
    "–ö—É—Ä—å–µ—Ä/–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π",  # –ó–≤–æ–Ω–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏
    "–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ",  # –ó–≤–æ–Ω–∫–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞, —Ä–µ–∫–ª–∞–º—ã, –ø–æ—Å—Ç–∞–≤–∫–∏
    "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"  # –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
]

# –û–ë–ù–û–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–æ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –ª–æ–≥–∏–∫—É –¥–æ–∫–æ–º–ø–ª–µ–∫—Ç–∞ –≤ –ø—Ä–æ–º–ø—Ç–µ.
PROMPT_TEMPLATE = '''–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–µ –∑–≤–æ–Ω–∫–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –º–µ–∂–¥—É –ú–µ–Ω–µ–¥–∂–µ—Ä–æ–º –∏ –ö–ª–∏–µ–Ω—Ç–æ–º –∏ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –¢–û–ß–ù–£–Æ –æ—Ü–µ–Ω–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É –∏–∑ 14 –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –∏–∑ —á–µ–∫-–ª–∏—Å—Ç–∞ –û–ö–ö. –ï—Å–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –∑–∞–¥–∞–ª –∫–∞–∫–æ–π-—Ç–æ –≤–æ–ø—Ä–æ—Å, –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —ç—Ç–æ –≤ SUMMARY

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞:**
–û–ø—Ä–µ–¥–µ–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–∞–Ω–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞ –∏–∑ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞: {}.
–í JSON-–æ—Ç–≤–µ—Ç–µ –¥–æ–±–∞–≤—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ "call_category" —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–∑ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞.
–ï—Å–ª–∏ "call_category" —Ä–∞–≤–Ω–æ "–ö—É—Ä—å–µ—Ä/–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π" –∏–ª–∏ "–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ" –∏–ª–∏ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ", —Ç–æ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ ("—É–ª—ã–±–∫–∞_–≤_–≥–æ–ª–æ—Å–µ", "—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ_–∫–æ–Ω—Ç–∞–∫—Ç–∞" –∏ —Ç.–¥., –∫—Ä–æ–º–µ "manager_name") –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã 0 (–Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ).

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –æ—Ü–µ–Ω–æ–∫ (–°–¢–†–û–ì–û –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è):**
* **1 (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ö—Ä–∏—Ç–µ—Ä–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏ —Å–æ–≥–ª–∞—Å–Ω–æ –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º.
* **0 (–Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ):** –ö—Ä–∏—Ç–µ—Ä–∏–π –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º –∫ –¥–∞–Ω–Ω–æ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–∏–∞–ª–æ–≥—É, —Ç–∞–∫ –∫–∞–∫ –Ω–µ –±—ã–ª–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∏–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
* **-1 (–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ö—Ä–∏—Ç–µ—Ä–∏–π –±—ã–ª –Ω–µ–æ–±—Ö–æ–¥–∏–º, –Ω–æ –º–µ–Ω–µ–¥–∂–µ—Ä –µ–≥–æ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª, –≤—ã–ø–æ–ª–Ω–∏–ª –ø–ª–æ—Ö–æ, –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª –∏–ª–∏ –¥–æ–ø—É—Å—Ç–∏–ª –æ—à–∏–±–∫—É.

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (—Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π –æ—Ü–µ–Ω–∫–∏):**

1.  **–£–ª—ã–±–∫–∞ –≤ –≥–æ–ª–æ—Å–µ, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π —Ç–æ–Ω:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ò–Ω—Ç–æ–Ω–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è, –≥–æ–ª–æ—Å —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π, –∑–≤—É—á–∏—Ç –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ –∏ –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ):** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ü–µ–Ω–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π –∏–ª–∏ —á–∏—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∑–≤–æ–Ω–æ–∫).
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ì–æ–ª–æ—Å –º–æ–Ω–æ—Ç–æ–Ω–Ω—ã–π, –±–µ–∑—Ä–∞–∑–ª–∏—á–Ω—ã–π, —É—Å—Ç–∞–≤—à–∏–π, –≥—Ä—É–±—ã–π –∏–ª–∏ –∏–∑–ª–∏—à–Ω–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏.

2.  **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–∫—Ç–∏–≤–Ω–æ —Å—Ç—Ä–µ–º–∏—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç, –∏—Å–ø–æ–ª—å–∑—É—è –∫–∞–∫ –º–∏–Ω–∏–º—É–º –î–í–ê –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—É–Ω–∫—Ç–æ–≤: 1) –£–ª—ã–±–∫–∞ –≤ –≥–æ–ª–æ—Å–µ, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π —Ç–æ–Ω —Ä–∞–∑–≥–æ–≤–æ—Ä–∞, 2) –ù–∞–∑—ã–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –∏–º–µ–Ω–∏ (–µ—Å–ª–∏ —ç—Ç–æ —É–º–µ—Å—Ç–Ω–æ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ), 3) –ö–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º—É –∫–ª–∏–µ–Ω—Ç–∞, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é), 4) –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–†–∞–¥—ã –≤–∞—Å —Å–ª—ã—à–∞—Ç—å!", "–í—ã —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä, –æ–±—Ä–∞—Ç–∏–≤—à–∏—Å—å –∫ –Ω–∞–º!").
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ö–æ—Ä–æ—Ç–∫–∏–π –∑–≤–æ–Ω–æ–∫ –∏–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª —Ç–∞–∫–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –¥–µ–ª—É –±–µ–∑ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞, –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è, –∏–ª–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –±—ã–ª–æ —Å—É—Ö–∏–º/—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—è –Ω–∏–∫–∞–∫–∏—Ö –ø—É–Ω–∫—Ç–æ–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞. 

3.  **–ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è (—á—Ç–æ –Ω—É–∂–Ω–æ, –∫–æ–≥–¥–∞, —Å—Ä–æ–∫–∏, –±—é–¥–∂–µ—Ç):**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞–ª –í–°–ï –¢–†–ò –∫–ª—é—á–µ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—é:  1) –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?, 2) –ö –∫–∞–∫–æ–π –¥–∞—Ç–µ –ø–æ–¥–±–∏—Ä–∞–µ—Ç–µ? 3) –ï—Å—Ç—å –ª–∏ —Ä–∞–º–∫–∏ –ø–æ –±—é–¥–∂–µ—Ç—É?, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞–∏–ª—É—á—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ö–ª–∏–µ–Ω—Ç —Å–∞–º —á–µ—Ç–∫–æ –∏ –ø–æ–ª–Ω–æ –æ–∑–≤—É—á–∏–ª –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è –ø–æ –≤—Å–µ–º —Ç—Ä–µ–º –ø—É–Ω–∫—Ç–∞–º.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞–ª –º–µ–Ω–µ–µ —Ç—Ä–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–∞ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—é, –≤–æ–ø—Ä–æ—Å—ã –Ω–µ—Ç–æ—á–Ω—ã–µ, –Ω–µ–ø–æ–ª–Ω—ã–µ, –∏–ª–∏ —Å—Ä–∞–∑—É –ø–µ—Ä–µ—à–µ–ª –∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—é –±–µ–∑ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–∏—Ç—É–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞.

4.  **–í—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ ‚Äî –∫–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É —Ä–µ—à–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞–ª –ë–û–õ–ï–ï –¢–†–ï–• –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –∏ –º–æ—Ç–∏–≤–∞—Ü–∏–π –∫–ª–∏–µ–Ω—Ç–∞. –°–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤: 1) –ö–∞–∫–æ–π —Ä–∞–∑–º–µ—Ä —Å–º–æ—Ç—Ä–∏—Ç–µ?, 2) –ö—É–¥–∞ –≤—ã–±–∏—Ä–∞–µ—Ç–µ?, 3) –ß—Ç–æ –¥–ª—è –≤–∞—Å –≤–∞–∂–Ω–æ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ä–∞—Å—Ç–µ–Ω–∏—è? (–¶–µ–Ω–∞, —Å—Ä–æ–∫–∏, –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã....), 4) –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ "—Ç–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç" —Ö–æ—Ç–∏—Ç–µ?, 5) –ü–µ—Ä–≤—ã–π —Ä–∞–∑ –ø–æ–∫—É–ø–∞–µ—Ç–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ?,  6) –£–∂–µ –∑–Ω–∞–µ—Ç–µ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Ö–∞–∂–∏–≤–∞—Ç—å –∑–∞ —Ä–∞—Å—Ç–µ–Ω–∏–µ–º?, 7) –í–∞–º –Ω—É–∂–Ω–æ –º–µ–Ω–µ–µ –ø—Ä–∏—Ö–æ—Ç–ª–∏–≤–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ –∏–ª–∏ —ç—Ç–æ –Ω–µ –≤–∞–∂–Ω–æ?.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ö–ª–∏–µ–Ω—Ç —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞ —á–µ—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª —Å–≤–æ—é –ø—Ä–æ–±–ª–µ–º—É –∏ —Ü–µ–ª—å –ø–æ–∫—É–ø–∫–∏, –Ω–µ –æ—Å—Ç–∞–≤–ª—è—è –º–µ—Å—Ç–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è, –∏–ª–∏ –∑–≤–æ–Ω–æ–∫ –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª –≥–ª—É–±–æ–∫–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞–ª –º–µ–Ω–µ–µ —Ç—Ä–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≤—ã—è–≤–ª–µ–Ω–∏–µ, –∏–ª–∏ –Ω–µ –ø—ã—Ç–∞–ª—Å—è –ø–æ–Ω—è—Ç—å –≥–ª—É–±–∏–Ω–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª —Å–∏–≥–Ω–∞–ª—ã –∫–ª–∏–µ–Ω—Ç–∞ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö.

5.  **–£—Ç–æ—á–Ω–µ–Ω–∏–µ —Ü–µ–ª–∏ –ø–æ–∫—É–ø–∫–∏ (–ø–æ–¥–∞—Ä–æ–∫/—Å–µ–±–µ/–æ—Ñ–∏—Å):** * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä —è–≤–Ω–æ –∑–∞–¥–∞–ª –≤–æ–ø—Ä–æ—Å –æ —Ü–µ–ª–∏ –ø–æ–∫—É–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≠—Ç–æ –¥–ª—è –≤–∞—Å –∏–ª–∏ –≤ –ø–æ–¥–∞—Ä–æ–∫?", "–≠—Ç–æ –¥–ª—è –¥–æ–º–∞ –∏–ª–∏ –≤ –æ—Ñ–∏—Å?", "–ö—É–¥–∞ –±–µ—Ä–µ—Ç–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ?"), –ø–æ–ª—É—á–∏–≤ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç–≤–µ—Ç.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ):** –ö—Ä–∏—Ç–µ—Ä–∏–π –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º –∫ –¥–∞–Ω–Ω–æ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–∏–∞–ª–æ–≥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–∞–º —Å–∫–∞–∑–∞–ª —Ü–µ–ª—å –ø–æ–∫—É–ø–∫–∏).
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –∑–∞–¥–∞–ª –≤–æ–ø—Ä–æ—Å –æ —Ü–µ–ª–∏ –ø–æ–∫—É–ø–∫–∏, —Ö–æ—Ç—è —ç—Ç–æ –±—ã–ª–æ —É–º–µ—Å—Ç–Ω–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏.
    
6. **–ü–æ—Å–ª–µ–¥—É—é—â–∏–π —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å (–£–≥–ª—É–±–ª–µ–Ω–∏–µ –≤ —Ü–µ–ª—å):**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞–ª –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –æ —Ü–µ–ª–∏ –ø–æ–∫—É–ø–∫–∏ **–ò** –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–¥–∞–ª **–ª–æ–≥–∏—á–Ω—ã–π, —É–≥–ª—É–±–ª—è—é—â–∏–π, –≤—Ç–æ—Ä–æ–π** —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç "–í –¥–æ–º" -> "–í –∫–∞–∫—É—é –∫–æ–º–Ω–∞—Ç—É?").
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ):** –ö—Ä–∏—Ç–µ—Ä–∏–π –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º –∫ –¥–∞–Ω–Ω–æ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–∏–∞–ª–æ–≥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—Ç—å –≤—Ç–æ—Ä–æ–π –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—ã–ª–∞ –ø–æ–ª—É—á–µ–Ω–∞ –≤ –æ–¥–Ω–æ–º —à–∞–≥–µ).
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –∑–∞–¥–∞–ª –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –æ —Ü–µ–ª–∏ –ø–æ–∫—É–ø–∫–∏ **–õ–ò–ë–û** –∑–∞–¥–∞–ª –ø–µ—Ä–≤—ã–π, –Ω–æ –Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞–ª **–ª–æ–≥–∏—á–Ω—ã–º —É–≥–ª—É–±–ª—è—é—â–∏–º** –≤–æ–ø—Ä–æ—Å–æ–º, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –±—ã–ª–æ —É–º–µ—Å—Ç–Ω–æ.

7.  **–ü–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ú–µ–Ω–µ–¥–∂–µ—Ä, –∏—Å—Ö–æ–¥—è –∏–∑ –≤—Å–µ—Ö –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –∏ –ø—Ä–æ–±–ª–µ–º –∫–ª–∏–µ–Ω—Ç–∞, –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–û –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ö–û–ù–ö–†–ï–¢–ù–û–ï —Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤. –ü—Ä–∏ —ç—Ç–æ–º –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∫–∞–∫ –º–∏–Ω–∏–º—É–º –û–î–ù–û–ì–û –±–ª–æ–∫–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ (–∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤: –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫–æ–º–ø–∞–Ω–∏–∏, –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥—É–∫—Ç–∞), –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫ 2-3 –≤—ã—è–≤–ª–µ–Ω–Ω—ã–º –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∞–º –∫–ª–∏–µ–Ω—Ç–∞. –¢–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –û–î–ù–ê –∏—Å—Ç–æ—Ä–∏—è/–∫–µ–π—Å –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–∏.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ö–ª–∏–µ–Ω—Ç —Ç–æ—á–Ω–æ –∑–Ω–∞–ª, —á—Ç–æ –µ–º—É –Ω—É–∂–Ω–æ, –∏ –Ω–µ –±—ã–ª–æ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—ã—è–≤–ª–µ–Ω–Ω—ã–º –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º, –∏–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ —Å–º–æ–≥ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–±—Ä–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∏–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –±–ª–æ–∫–∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏/–∏—Å—Ç–æ—Ä–∏–∏, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º –∫–ª–∏–µ–Ω—Ç–∞.

8.  **–ü—Ä–æ–≥–æ–≤–æ—Ä–∏—Ç—å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–π:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –ü–†–û–ê–ö–¢–ò–í–ù–û –∏ –ü–û–õ–ù–û–°–¢–¨–Æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö, —Å–ª–æ–∂–Ω–æ—Å—Ç—è—Ö —É—Ö–æ–¥–∞, —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏, —É—Å–ª–æ–≤–∏—è—Ö –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≠—Ç–æ—Ç —Å–æ—Ä—Ç —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ —Å–≤–µ—Ç–∞ –∏ –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —Å–∫–≤–æ–∑–Ω—è–∫–æ–≤", "–≠—Ç–æ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ, –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ", "–ù—É–∂–µ–Ω –æ—Å–æ–±—ã–π –≥—Ä—É–Ω—Ç").
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ù–µ –±—ã–ª–æ –ø–æ–∑–∏—Ü–∏–π —Å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏, —Ç—Ä–µ–±—É—é—â–∏–º–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è, –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç —É–∂–µ –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ —É–ø–æ–º—è–Ω—É–ª –≤–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –æ–∂–∏–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞, –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—ã–ª–∞ –Ω–µ–ø–æ–ª–Ω–æ–π/–Ω–µ—è—Å–Ω–æ–π.

9.  **–í–æ–∑—Ä–∞–∂–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ ‚Äî —Ñ—Ä–∞–∑–∞:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ):** –ö–ª–∏–µ–Ω—Ç —á–µ—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ, —Å–æ–º–Ω–µ–Ω–∏–µ, –æ—Ç–∫–∞–∑ –∏–ª–∏ –≤—Å—Ç—Ä–µ—á–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–≠—Ç–æ –¥–æ—Ä–æ–≥–æ", "–Ø –ø–æ–¥—É–º–∞—é", "–£ –º–µ–Ω—è —É–∂–µ —Ç–∞–∫–æ–µ –±—ã–ª–æ, –æ–Ω–æ –∑–∞—Å–æ—Ö–ª–æ", "–ú–Ω–µ –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ü–≤–µ—Ç"). –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ—Ä–∞–∑–∞, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∞—è –Ω–∞–ª–∏—á–∏–µ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –í–æ–∑—Ä–∞–∂–µ–Ω–∏–π —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ –±—ã–ª–æ.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –í–æ–∑—Ä–∞–∂–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –±—ã–ª–æ, –Ω–æ –º–µ–Ω–µ–¥–∂–µ—Ä –µ–≥–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª, –Ω–µ –¥–∞–ª –∫–ª–∏–µ–Ω—Ç—É –≤—ã—Å–∫–∞–∑–∞—Ç—å—Å—è –∏–ª–∏ –ø–µ—Ä–µ–±–∏–ª –µ–≥–æ, –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–≤ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ.

10.  **–û—Ç—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è:** (–≠—Ç–æ—Ç –∫—Ä–∏—Ç–µ—Ä–∏–π –∞–∫—Ç—É–∞–ª–µ–Ω, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã–ª–æ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ)
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–∫—Ç–∏–≤–Ω–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ–º, –ø—Ä–∏–º–µ–Ω–∏–≤ —Ñ–æ—Ä–º—É–ª—É —Ä–∞–±–æ—Ç—ã —Å –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–∫–∞–∫ –º–∏–Ω–∏–º—É–º –î–í–ï –ü–û–ü–´–¢–ö–ò –æ—Ç—Ä–∞–±–æ—Ç–∫–∏, –∫–∞–∂–¥–∞—è –≤–∫–ª—é—á–∞–µ—Ç: 1) –£—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å, 2) –ê—Ä–≥—É–º–µ–Ω—Ç, 3) –ó–∞–∫—Ä—ã–≤–∞—é—â–∏–π –≤–æ–ø—Ä–æ—Å). –ü–æ –∏—Ç–æ–≥—É –¥–∏–∞–ª–æ–≥–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ —Å–Ω—è—Ç–æ –∏–ª–∏ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—å—Å—è –¥–∞–ª—å—à–µ –ø–æ —Å–¥–µ–ª–∫–µ.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –í–æ–∑—Ä–∞–∂–µ–Ω–∏–π –Ω–µ –±—ã–ª–æ –∏–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏–º–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –æ—Ç—Ä–∞–±–æ—Ç–∫–∏.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –®—Ç—Ä–∞—Ñ—É–µ—Ç—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ø—É–Ω–∫—Ç 1 –≤ "–í–æ–∑—Ä–∞–∂–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞". –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ, –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –µ–≥–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ (–∞—Ä–≥—É–º–µ–Ω—Ç—ã –Ω–µ—É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã, –º–µ–Ω–µ–¥–∂–µ—Ä —Å–ø–æ—Ä–∏—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–º, –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è), —É—Å—É–≥—É–±–∏–ª –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Ñ–æ—Ä–º—É–ª–µ —Ä–∞–±–æ—Ç—ã —Å –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è–º–∏.
    –ï—Å–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –≤–æ–∑—Ä–∞ –∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, —Ç–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ SUMMARY –≤ —á–µ–º –∏–º–µ–Ω–Ω–æ –±—ã–ª–∞ –æ—à–∏–±–∫–∞.

11. **–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–æ–∫–æ–º–ø–ª–µ–∫—Ç:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã (–¥–æ–∫–æ–º–ø–ª–µ–∫—Ç), –ª–æ–≥–∏—á–µ—Å–∫–∏ –¥–æ–ø–æ–ª–Ω—è—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—É—é –ø–æ–∫—É–ø–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞—à–ø–æ, –≥—Ä—É–Ω—Ç, –ø–µ—Ä–µ—Å–∞–¥–∫–∞, –¥—Ä–µ–Ω–∞–∂), –∏ –ø—Ä–∏–º–µ–Ω–∏–ª —Ñ–æ—Ä–º—É–ª—É –æ—Ñ—Ñ–µ—Ä–∞ –¥–æ–ø–ø—Ä–æ–¥–∞–∂–∏: 1) –£–ø–æ–º—è–Ω—É–ª, —á—Ç–æ –¥—Ä—É–≥–∏–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–∫—É–ø–∞—é—Ç —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, 2) –û–±—ä—è—Å–Ω–∏–ª, –ø–æ—á–µ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ/–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ/–ø–æ–ª–µ–∑–Ω–æ/–≤—ã–≥–æ–¥–Ω–æ –∫–ª–∏–µ–Ω—Ç—É, 3) –°–¥–µ–ª–∞–ª –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–∞ –ø–æ–∫—É–ø–∫—É (—Å 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –≤—ã–±–æ—Ä–∞).
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–≤–æ–Ω–∫–∞ –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª –¥–æ–∫–æ–º–ø–ª–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∏–µ–Ω—Ç —É–∂–µ –∫—É–ø–∏–ª –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∏–ª–∏ –∑–≤–æ–Ω–æ–∫ –Ω–µ –¥–æ—à–µ–ª –¥–æ —ç—Ç–∞–ø–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞). **–í–ù–ò–ú–ê–ù–ò–ï: –ï—Å–ª–∏ –≤ –∑–∞–∫–∞–∑–µ —É–∂–µ –µ—Å—Ç—å –∏ –†–∞—Å—Ç–µ–Ω–∏–µ, –∏ –ö–∞—à–ø–æ, —É—Å—Ç–∞–Ω–æ–≤–∏ 0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ).**
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä —É–ø—É—Å—Ç–∏–ª –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–æ–∫–æ–º–ø–ª–µ–∫—Ç, —Ö–æ—Ç—è –æ–Ω–∞ –±—ã–ª–∞ –æ—á–µ–≤–∏–¥–Ω–∞ –∏ —É–º–µ—Å—Ç–Ω–∞, –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–æ —Ñ–æ—Ä–º—É–ª–µ –¥–æ–ø–ø—Ä–æ–¥–∞–∂–∏.
    –ï—Å–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –ø—Ä–µ–¥–ª–æ–∂–∏–ª –¥–æ–∫–æ–º–ª–µ–∫—Ç –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, —Ç–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ SUMMARY –≤ —á–µ–º –∏–º–µ–Ω–Ω–æ –±—ã–ª–∞ –æ—à–∏–±–∫–∞.

12. **–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–æ–ø—Ä–æ–¥–∞–∂—É:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–µ–¥–ª–æ–∂–∏–ª –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏–ª–∏ —É—Å–ª—É–≥–∏ (–¥–æ–ø—Ä–æ–¥–∞–∂—É), —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–µ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, –Ω–æ –Ω–µ —è–≤–ª—è—é—â–∏–µ—Å—è –ø—Ä—è–º—ã–º –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ç–æ–≤–∞—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—Ä—É–≥–∏–µ —Ä–∞—Å—Ç–µ–Ω–∏—è, —É–¥–æ–±—Ä–µ–Ω–∏—è, –æ—Å–≤–µ—â–µ–Ω–∏–µ, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã, —Å–µ—Ä–≤–∏—Å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ), –∏ –ø—Ä–∏–º–µ–Ω–∏–ª —Ñ–æ—Ä–º—É–ª—É –æ—Ñ—Ñ–µ—Ä–∞ –¥–æ–ø–ø—Ä–æ–¥–∞–∂–∏: 1) –£–ø–æ–º—è–Ω—É–ª, —á—Ç–æ –¥—Ä—É–≥–∏–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–∫—É–ø–∞—é—Ç —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, 2) –û–±—ä—è—Å–Ω–∏–ª, –ø–æ—á–µ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ/–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ/–ø–æ–ª–µ–∑–Ω–æ/–≤—ã–≥–æ–¥–Ω–æ –∫–ª–∏–µ–Ω—Ç—É, 3) –°–¥–µ–ª–∞–ª –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–∞ –ø–æ–∫—É–ø–∫—É (—Å 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –≤—ã–±–æ—Ä–∞).
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –ø—Ä–µ–¥–ª–æ–∂–∏–ª –¥–æ–ø—Ä–æ–¥–∞–∂—É, —Ö–æ—Ç—è —Ç–∞–∫–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã–ª–∞ –æ—á–µ–≤–∏–¥–Ω–∞ –∏ –º–æ–≥–ª–∞ —É–≤–µ–ª–∏—á–∏—Ç—å —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞, –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–æ —Ñ–æ—Ä–º—É–ª–µ –¥–æ–ø–ø—Ä–æ–¥–∞–∂–∏.
    –ï—Å–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –ø—Ä–µ–¥–ª–æ–∂–∏–ª –¥–æ–ø—Ä–æ–¥–∞–∂—É –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, —Ç–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ SUMMARY –≤ —á–µ–º –∏–º–µ–Ω–Ω–æ –±—ã–ª–∞ –æ—à–∏–±–∫–∞.

13. **–ü—Ä–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞ –∏ –æ–±—â—É—é —Å—É–º–º—É:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –ß–ï–¢–ö–û, –ü–û–õ–ù–û–°–¢–¨–Æ –∏ –û–î–ù–û–ó–ù–ê–ß–ù–û –æ–∑–≤—É—á–∏–≤–∞–µ—Ç –ø–µ—Ä–µ—á–µ–Ω—å –≤—Å–µ—Ö –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ò–¢–û–ì–û–í–£–Æ –°–£–ú–ú–£ –∑–∞–∫–∞–∑–∞. (–ü—Ä–∏–º–µ—Ä: "–ò—Ç–∞–∫, –≤ –≤–∞—à–µ–º –∑–∞–∫–∞–∑–µ: [–ø–æ–∑–∏—Ü–∏—è1] –∑–∞ [—Å—É–º–º–∞1], [–ø–æ–∑–∏—Ü–∏—è2] –∑–∞ [—Å—É–º–º–∞2], –∏—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ [–æ–±—â–∞—è —Å—É–º–º–∞] —Ä—É–±–ª–µ–π").
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ó–≤–æ–Ω–æ–∫ –Ω–µ –¥–æ—à–µ–ª –¥–æ —ç—Ç–∞–ø–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –æ–∑–≤—É—á–∏–ª —Å–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞, –∏–ª–∏ —Å—É–º–º—É, –∏–ª–∏ —Å–¥–µ–ª–∞–ª —ç—Ç–æ –Ω–µ—á–µ—Ç–∫–æ/–Ω–µ–ø–æ–ª–Ω–æ, —Å–æ–∑–¥–∞–≤ –ø—É—Ç–∞–Ω–∏—Ü—É.

14. **–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ (–∞–¥—Ä–µ—Å; —Å—Ä–æ–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏):**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∏–ª–∏ —É—Ç–æ—á–Ω—è–µ—Ç –ö–õ–Æ–ß–ï–í–´–ï –¥–µ—Ç–∞–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏: —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (–∏–ª–∏ —É—Å–ª–æ–≤–∏—è —Å–∞–º–æ–≤—ã–≤–æ–∑–∞), –∂–µ–ª–∞–µ–º—ã–µ/–≤–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ä–æ–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏/–ø–æ–ª—É—á–µ–Ω–∏—è, –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ñ—Ä–∞–∑–∞ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–µ–π —Å 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –Ω–∞ –≤—ã–±–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¢–æ–≥–¥–∞ –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ–º—Å—è, —á—Ç–æ –ø—Ä–∏–µ–¥–µ—Ç–µ –∫ –Ω–∞–º —Å–µ–≥–æ–¥–Ω—è –≤ 16.00...", "–û—Ç–ª–∏—á–Ω–æ, –ø—Ä–∏–¥–µ—Ä–∂—É –∑–∞ –≤–∞–º–∏ —Ä–∞—Å—Ç–µ–Ω–∏—è, –∫ –∫–æ–Ω—Ü—É –¥–Ω—è –±—É–¥—É –∂–¥–∞—Ç—å –æ–ø–ª–∞—Ç—É...").
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –ó–≤–æ–Ω–æ–∫ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –¥–æ —ç—Ç–∞–ø–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–∞–∑–∞–ª—Å—è –∏–ª–∏ –ø—Ä–µ—Ä–≤–∞–ª –∑–≤–æ–Ω–æ–∫ –¥–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞).
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ —É—Ç–æ—á–Ω–∏–ª –∏–ª–∏ —É–ø—É—Å—Ç–∏–ª –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏/–ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞, –∏–ª–∏ —ç—Ç–∏ –¥–µ—Ç–∞–ª–∏ –±—ã–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã –Ω–µ—è—Å–Ω–æ, –∏–ª–∏ –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏.

15. **–ü—Ä–æ–≥–æ–≤–æ—Ä–∏—Ç—å –ø—Ä–æ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É –ø–æ —Å—Ö–µ–º–µ: –¥–µ–¥–ª–∞–π–Ω + –ø—Ä–∏—á–∏–Ω–∞:**
    * **1 (–í—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä —á–µ—Ç–∫–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –£–°–õ–û–í–ò–Ø –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–µ–¥–ª–∞–π–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–æ–ø–ª–∞—Ç–∏—Ç–µ –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞", "—Å–µ–≥–æ–¥–Ω—è –¥–æ –∫–æ–Ω—Ü–∞ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è") –∏ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –û–ë–™–Ø–°–ù–Ø–ï–¢ –ø—Ä–∏—á–∏–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å—Ç–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –±–∏—Ä–æ—á–∫–∏ –≤–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã", "–¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –µ–≥–æ –≤ —Å–±–æ—Ä–∫—É"). –ú–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–µ–¥–ª–∞–π–Ω-–±–æ–Ω—É—Å –¥–ª—è —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–ª–∞—Ç—ã.
    * **0 (–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)::** –£—Å–ª–æ–≤–∏—è —Å–¥–µ–ª–∫–∏ –Ω–µ –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∏ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã.
    * **-1 (–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)::** –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –ø—Ä–æ–≥–æ–≤–æ—Ä–∏–ª –ø—Ä–æ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É, –ø—Ä–æ–≥–æ–≤–æ—Ä–∏–ª –Ω–µ—á–µ—Ç–∫–æ, –±–µ–∑ –¥–µ–¥–ª–∞–π–Ω–∞ –∏–ª–∏ –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–∏—á–∏–Ω—ã, –Ω–µ —Å–º–æ–≥ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–µ, –∏–ª–∏ —É–ø—É—Å—Ç–∏–ª –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–µ–¥–ª–∞–π–Ω-–±–æ–Ω—É—Å–∞ –ø—Ä–∏ –µ–≥–æ —É–º–µ—Å—Ç–Ω–æ—Å—Ç–∏.

–¢–∞–∫–∂–µ, –µ—Å–ª–∏ –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª—Å—è, —É–∫–∞–∂–∏ –µ–≥–æ –∏–º—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø–æ–ª–µ–º "manager_name" –≤ –∫–æ–Ω—Ü–µ JSON-–æ—Ç–≤–µ—Ç–∞. **–ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ –∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞. –≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –ò–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä–æ–≥–æ –∏–∑ —Å–ø–∏—Å–∫–∞. –ï—Å–ª–∏ –∏–º—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, —É–∫–∞–∂–∏ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ".**
–ù–µ –ø—É—Ç–∞–π, –∫–æ–≥–¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª—Å—è –º–µ–Ω–µ–¥–∂–µ—Ä, –∞ –∫–æ–≥–¥–∞ –æ–Ω –Ω–∞–∑–≤–∞–ª –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞.

**–í–æ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏–º–µ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–π –∏—Ö —Ç–æ—á–Ω–æ –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ:**
{}

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:**
–°—Ç—Ä–æ–≥–æ JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –æ—Ü–µ–Ω–æ–∫ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤, –∏–º–µ–Ω–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–≤–æ–Ω–∫–∞. –ü–æ—Å–ª–µ JSON –±–ª–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞ `---SUMMARY---`, –∞ –∑–∞—Ç–µ–º –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –∑–≤–æ–Ω–∫–∞ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –≤—ã–≤–æ–¥–∞–º–∏ –¥–ª—è –†–û–ü–∞ (–Ω–µ –±–æ–ª–µ–µ 1600 —Å–∏–º–≤–æ–ª–æ–≤).

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–∑—é–º–µ (summary):**
–†–µ–∑—é–º–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –¥–ª—è –†–û–ü–∞, –æ—Ç–≤–µ—á–∞—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã. –ò—Å–ø–æ–ª—å–∑—É–π HTML-—Ç–µ–≥ `<b>` –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∂–∏—Ä–Ω—ã–º –∂–∏—Ä–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º –∏ —Ä–∞–∑–¥–µ–ª—è–π –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å.
* <b>–ò—Å—Ö–æ–¥ –∑–≤–æ–Ω–∫–∞:</b> –ß–µ–º –∑–∞–∫–æ–Ω—á–∏–ª—Å—è —Ä–∞–∑–≥–æ–≤–æ—Ä (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ–∑–∂–µ, –∑–∞–∫–∞–∑, –æ—Ç–∫–∞–∑, –≤–∏–∑–∏—Ç –≤ —à–æ—É—Ä—É–º, –∑–∞–ø—Ä–æ—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Ç.–¥.).
* <b>–ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è:</b> –ö–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞–ª –ø–æ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –±—é–¥–∂–µ—Ç—É, —Å—Ä–æ–∫–∞–º) –∏–ª–∏ –ø–æ—á–µ–º—É –Ω–µ –∑–∞–¥–∞–ª.
* <b>–í—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π:</b> –ö–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–¥–∞–ª –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ –ø–æ—á–µ–º—É –Ω–µ –∑–∞–¥–∞–ª.
* <b>–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è:</b> –ö–∞–∫ –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–µ–∑–µ–Ω—Ç–æ–≤–∞–ª —Ä–µ—à–µ–Ω–∏–µ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Ä–∞—Å—Å–∫–∞–∑–∞–ª –æ –ø—Ä–æ–¥—É–∫—Ç–µ/–∫–æ–º–ø–∞–Ω–∏–∏.
* <b>–ü–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ:</b> –ü—ã—Ç–∞–ª—Å—è –ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π, –∏ —Å –∫–∞–∫–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º.
* <b>–í–æ–∑—Ä–∞–∂–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞:</b> –ï—Å–ª–∏ –±—ã–ª–∏, –ø—Ä–æ–ø–∏—à–∏ —Ç–µ–∫—Å—Ç–æ–º, —á—Ç–æ —Å–∫–∞–∑–∞–ª –∫–ª–∏–µ–Ω—Ç.
* <b>–û—Ç—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π:</b> –ï—Å–ª–∏ –±—ã–ª–∏ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è, —á—Ç–æ –≥–æ–≤–æ—Ä–∏–ª –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–∏ –∏—Ö –æ—Ç—Ä–∞–±–æ—Ç–∫–µ.
* <b>–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π:</b> –ö–ª–∏–µ–Ω—Ç —Å–æ–≥–ª–∞—Å–∏–ª—Å—è –∏–ª–∏ –æ—Ç–∫–∞–∑–∞–ª—Å—è –ø–æ—Å–ª–µ –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è.
* <b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ (–¥–æ–∫–æ–º–ø–ª–µ–∫—Ç/–¥–æ–ø—Ä–æ–¥–∞–∂–∞):</b> –ë—ã–ª–∏ –ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω—ã –¥–æ–∫–æ–º–ø–ª–µ–∫—Ç/–¥–æ–ø—Ä–æ–¥–∞–∂–∞, –∏ –µ—Å–ª–∏ –Ω–µ—Ç, —Ç–æ –ø–æ—á–µ–º—É —É–ø—É—â–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å.
* <b>–î–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:</b> –ö–∞–∫–∏–µ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–Ω–µ–¥–∂–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∏–ª —Å –∫–ª–∏–µ–Ω—Ç–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ –¥–æ—Å—Ç–∞–≤–∫–µ, –æ–ø–ª–∞—Ç–µ).
* <b>–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:</b> –ö–∞–∫–∏–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –±—ã–ª–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –∏–ª–∏ –ø–æ—á–µ–º—É –Ω–µ –±—ã–ª–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã.
* <b>–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</b> –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –≤ —Ä–∞–±–æ—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é –Ω–∞–≤—ã–∫–æ–≤ –∏–ª–∏ –ø–æ–¥—Ö–æ–¥–æ–≤).

–ü—Ä–∏–º–µ—Ä JSON:
{{
  "call_category": "–ó–∞–∫–∞–∑",
  "—É–ª—ã–±–∫–∞_–≤_–≥–æ–ª–æ—Å–µ": 1,
  "—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ_–∫–æ–Ω—Ç–∞–∫—Ç–∞": 1,
  "–∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è": 0,
  "–≤—ã—è–≤–ª–µ–Ω–∏–µ_–ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏": 1,
  "goal_clarified": 1,
  "–ø–æ—Å–ª–µ–¥—É—é—â–∏–π_—É—Ç–æ—á–Ω—è—é—â–∏–π": 1,
  "–ø–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ": 1,
  "–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏_–ø–æ–∑–∏—Ü–∏–π": 0,
  "–≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ": 1,
  "–æ—Ç—Ä–∞–±–æ—Ç–∫–∞_–≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è": 1,
  "–¥–æ–∫–æ–º–ø–ª–µ–∫—Ç": 0,
  "–¥–æ–ø—Ä–æ–¥–∞–∂–∞": 0,
  "—Å–æ—Å—Ç–∞–≤_–∏_—Å—É–º–º–∞": 1,
  "—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ_–¥–µ—Ç–∞–ª–µ–π": 1,
  "–ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞": 1,
  "manager_name": "–û–ª—å–≥–∞"
}}
---SUMMARY---
* <b>–ò—Å—Ö–æ–¥ –∑–≤–æ–Ω–∫–∞:</b> –†–∞–∑–≥–æ–≤–æ—Ä –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º –∑–∞–∫–∞–∑–∞ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ–º —É—Å–ª–æ–≤–∏–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã.

* <b>–ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è:</b> –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –∑–∞–¥–∞–ª –≤–æ–ø—Ä–æ—Å—ã –ø–æ –±—é–¥–∂–µ—Ç—É –∏ —Å—Ä–æ–∫–∞–º.

* <b>–í—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π:</b> –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –∑–∞–¥–∞–ª –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –∫–ª–∏–µ–Ω—Ç–∞.

* <b>–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è:</b> –ú–µ–Ω–µ–¥–∂–µ—Ä –∫—Ä–∞—Ç–∫–æ —Ä–∞—Å—Å–∫–∞–∑–∞–ª –æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö —Ç–æ–≤–∞—Ä–∞, –Ω–æ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–ª –∏—Ö –∫ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º –∫–ª–∏–µ–Ω—Ç–∞.

* <b>–ü–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ:</b> –ú–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –ø—ã—Ç–∞–ª—Å—è –ø–µ—Ä–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ.

* <b>–í–æ–∑—Ä–∞–∂–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞:</b> –ö–ª–∏–µ–Ω—Ç —Å–∫–∞–∑–∞–ª: "–≠—Ç–æ —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ".

* <b>–û—Ç—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π:</b> –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –±–æ–ª–µ–µ –±—é–¥–∂–µ—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

* <b>–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π:</b> –ö–ª–∏–µ–Ω—Ç —Å–æ–≥–ª–∞—Å–∏–ª—Å—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

* <b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ (–¥–æ–∫–æ–º–ø–ª–µ–∫—Ç/–¥–æ–ø—Ä–æ–¥–∞–∂–∞):</b> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–ø—Ä–æ–¥–∞–∂–∏ –±—ã–ª–∞ —É–ø—É—â–µ–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã.

* <b>–î–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:</b> –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –∏ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–µ.

* <b>–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:</b> –ú–µ–Ω–µ–¥–∂–µ—Ä –æ–±–æ–∑–Ω–∞—á–∏–ª —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –æ–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤.

* <b>–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</b> –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–ª—É—á—à–∏—Ç—å –Ω–∞–≤—ã–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞, –∑–∞–¥–∞–≤–∞—Ç—å –±–æ–ª—å—à–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –∫–ª–∏–µ–Ω—Ç–∞ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞.
–¢–µ–∫—Å—Ç –∑–≤–æ–Ω–∫–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:
"""
{transcript}
"""
'''


def clean_json_string(raw_content):
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç JSON-—Å—Ç—Ä–æ–∫—É –∏–∑ –æ—Ç–≤–µ—Ç–∞ –º–æ–¥–µ–ª–∏, –Ω–∞—Ö–æ–¥—è –ø–µ—Ä–≤—ã–π '{' –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π '}'.
    """
    first_brace = raw_content.find('{')
    last_brace = raw_content.rfind('}')

    if first_brace != -1 and last_brace != -1 and last_brace > first_brace:
        return raw_content[first_brace: last_brace + 1]
    return '{}'


def extract_summary(raw_content):
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–µ–∑—é–º–µ –∏–∑ –æ—Ç–≤–µ—Ç–∞ –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è ---SUMMARY---.
    """
    # –ò—â–µ–º —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ "---SUMMARY---"
    match = re.search(r'---SUMMARY---\s*([\s\S]*)', raw_content)
    return match.group(1).strip() if match else ''


# –§—É–Ω–∫—Ü–∏—è categorize_call_by_metadata –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ª–æ–≥–∏–∫—É –∞–Ω–∞–ª–∏–∑–∞ LLM/CRM
def categorize_call_by_metadata(raw_call_data: dict) -> str:
    """
    –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ—Ç –∑–≤–æ–Ω–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏).
    """
    direction = raw_call_data.get("direction")
    duration = raw_call_data.get("duration")

    # –ï—Å–ª–∏ –∑–≤–æ–Ω–æ–∫ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π (–º–µ–Ω–µ–µ 10 —Å–µ–∫—É–Ω–¥) –∏ –∏—Å—Ö–æ–¥—è—â–∏–π,
    # –≤–µ—Ä–æ—è—Ç–Ω–æ, —ç—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∑–≤–æ–Ω–æ–∫ –∏–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π
    if direction == "out" and duration is not None and duration < 10:
        return "–ö—É—Ä—å–µ—Ä/–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π"

    # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Å—á–∏—Ç–∞–µ–º "–ó–∞–∫–∞–∑"
    return "–ó–∞–∫–∞–∑"


def analyze_single_transcript(transcript_path: Path, target_folder_date_str: str, initial_category: str,
                              phone_number: str | None = None):
    """
    –ü—Ä–æ–≤–æ–¥–∏—Ç –∞–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–∏–¥–µ JSON-—Ñ–∞–π–ª–∞.
    """
    output_folder = Path("analyses") / f"—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è_{target_folder_date_str}"
    os.makedirs(output_folder, exist_ok=True)

    filename = transcript_path.name
    with open(transcript_path, "r", encoding="utf-8") as f:
        transcript = f.read()

    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º PROMPT_TEMPLATE
    prompt = PROMPT_TEMPLATE.format(
        ", ".join(CALL_CATEGORIES),
        ", ".join(ALLOWED_MANAGERS),
        transcript=transcript
    )

    success = False
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ–≤–∞—Ä—è —Å –Ω–æ–≤—ã–º –∫—Ä–∏—Ç–µ—Ä–∏–µ–º
    filtered_result = {key: 0 for key in CRITERIA}
    filtered_result["manager_name"] = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
    filtered_result["summary"] = ""
    filtered_result["call_category"] = initial_category

    # --- –ù–û–í–´–ô –ë–õ–û–ö: –ü–æ–∏—Å–∫ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–∫–∞–∑ –∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–π ---
    order_link = ""
    items_status = {'has_plant': False, 'has_cachepot': False}  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

    if phone_number:
        print(f"üîó –ü–æ–∏—Å–∫ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–∫–∞–∑ –∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–π –¥–ª—è –Ω–æ–º–µ—Ä–∞: {phone_number}...")
        order_link = get_order_link_by_phone(phone_number)
        items_status = get_order_items_status(phone_number)  # –í–´–ó–û–í –ù–û–í–û–ô –§–£–ù–ö–¶–ò–ò
        print(f"üîó –†–µ–∑—É–ª—å—Ç–∞—Ç: {order_link or '–ù–µ –Ω–∞–π–¥–µ–Ω–∞'}. –°—Ç–∞—Ç—É—Å –ø–æ–∑–∏—Ü–∏–π: {items_status}")
    else:
        print("üîó –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–æ–∏—Å–∫ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–∫–∞–∑ –∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–π.")
    # --- –ö–û–ù–ï–¶ –ù–û–í–û–ì–û –ë–õ–û–ö–ê ---

    for attempt in range(3):
        try:
            response = client.chat.completions.create(
                model="gpt-5-mini",
                messages=[{"role": "user", "content": prompt}],
            )
            raw_content = response.choices[0].message.content
            json_str = clean_json_string(raw_content)
            result_dict = json.loads(json_str)

            call_category_from_llm = result_dict.get("call_category")
            if call_category_from_llm in CALL_CATEGORIES:
                filtered_result["call_category"] = call_category_from_llm
            else:
                print(
                    f"‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∑–≤–æ–Ω–∫–∞ –æ—Ç LLM: {call_category_from_llm}. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: {initial_category}.")
                filtered_result["call_category"] = initial_category

            analysis_summary = extract_summary(raw_content)
            if not analysis_summary:
                print(f"‚ö†Ô∏è –†–µ–∑—é–º–µ –¥–ª—è {filename} –ø—É—Å—Ç–æ–µ.")
                analysis_summary = "–†–µ–∑—é–º–µ –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ."

            if filtered_result["call_category"] != "–ó–∞–∫–∞–∑":
                for key in CRITERIA:
                    filtered_result[key] = 0
                print(
                    f"‚ÑπÔ∏è –ó–≤–æ–Ω–æ–∫ {filename} –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ '{filtered_result['call_category']}'. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ 0.")
            else:
                for key in CRITERIA:
                    score = result_dict.get(key)
                    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª—è goal_clarified –≤ result_dict
                    if key == "goal_clarified" and score is None:
                        # –ï—Å–ª–∏ LLM –Ω–µ –≤–µ—Ä–Ω—É–ª –Ω–æ–≤–æ–µ –ø–æ–ª–µ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 0
                        score = 0

                    if score in [1, 0, -1]:
                        filtered_result[key] = score
                    else:
                        print(f"‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –±–∞–ª–ª {score} –¥–ª—è –∫—Ä–∏—Ç–µ—Ä–∏—è '{key}' –≤ —Ñ–∞–π–ª–µ {filename}. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º 0.")
                        filtered_result[key] = 0

                # --- –õ–û–ì–ò–ö–ê –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ì–û –£–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø "–î–û–ö–û–ú–ü–õ–ï–ö–¢" –í 0 ---
                if items_status['has_plant'] and items_status['has_cachepot']:
                    # –ï—Å–ª–∏ –≤ –∑–∞–∫–∞–∑–µ —É–∂–µ –µ—Å—Ç—å –∏ —Ä–∞—Å—Ç–µ–Ω–∏–µ, –∏ –∫–∞—à–ø–æ, —Ç–æ –¥–æ–∫–æ–º–ø–ª–µ–∫—Ç –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º
                    filtered_result["–¥–æ–∫–æ–º–ø–ª–µ–∫—Ç"] = 0
                    print(f"‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ '–¥–æ–∫–æ–º–ø–ª–µ–∫—Ç'=0 –¥–ª—è {filename}: –†–∞—Å—Ç–µ–Ω–∏–µ –∏ –ö–∞—à–ø–æ —É–∂–µ –≤ –∑–∞–∫–∞–∑–µ.")
                # --- –ö–û–ù–ï–¶ –õ–û–ì–ò–ö–ò –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ì–û –£–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø "–î–û–ö–û–ú–ü–õ–ï–ö–¢" –í 0 ---

            manager_name_from_llm = result_dict.get("manager_name")
            if manager_name_from_llm in ALLOWED_MANAGERS:
                filtered_result["manager_name"] = manager_name_from_llm
            else:
                filtered_result["manager_name"] = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"

            filtered_result["summary"] = analysis_summary
            success = True
            break
        except json.JSONDecodeError as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ JSON –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è {filename} (–ø–æ–ø—ã—Ç–∫–∞ {attempt + 1}): {e}")
            print(f"–°—ã—Ä–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (–Ω–∞—á–∞–ª–æ): {raw_content[:500]}...")
            time.sleep(2)
        except Exception as e:
            print(f"‚ö†Ô∏è –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏/–ø–∞—Ä—Å–∏–Ω–≥–µ –¥–ª—è {filename} (–ø–æ–ø—ã—Ç–∫–∞ {attempt + 1}): {e}")
            time.sleep(2)

    if filtered_result["manager_name"] == "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ" and phone_number:
        print(f"‚ÑπÔ∏è –ò–º—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ LLM. –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–∑ CRM –¥–ª—è –Ω–æ–º–µ—Ä–∞: {phone_number}")
        crm_manager_name = get_manager_name_from_crm(phone_number)
        if crm_manager_name and crm_manager_name in ALLOWED_MANAGERS:
            filtered_result["manager_name"] = crm_manager_name
            print(f"‚úÖ –ò–º—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ –∏–∑ CRM: {crm_manager_name}")
        else:
            print("‚ÑπÔ∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–º—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∏–∑ CRM.")

    if not success:
        fail_path = output_folder / f"{filename.replace('.txt', '')}_raw.txt"
        with open(fail_path, "w", encoding="utf-8") as f:
            f.write(transcript)
        print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å: {filename} ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∫–∞–∫ {fail_path}")
        if filtered_result["manager_name"] == "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ":
            filtered_result["manager_name"] = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
        filtered_result["summary"] = "–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ."
        filtered_result["call_category"] = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
        for key in CRITERIA:
            filtered_result[key] = 0

    if filtered_result["call_category"] != "–ö—É—Ä—å–µ—Ä/–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π":
        out_path = output_folder / f"{transcript_path.stem}_analysis.json"

        # –î–æ–±–∞–≤–ª—è–µ–º order_link –∏ items_status –≤ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ JSON
        final_analysis_data = filtered_result.copy()
        final_analysis_data["order_link"] = order_link
        final_analysis_data["order_items_status"] = items_status  # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∑–∏—Ü–∏–π

        with open(out_path, "w", encoding="utf-8") as f:
            json.dump(final_analysis_data, f, ensure_ascii=False, indent=2)
        print(f"‚úÖ –ê–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω: {out_path}")
    else:
        print(f"‚è© –ó–≤–æ–Ω–æ–∫ {filename} –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ '–ö—É—Ä—å–µ—Ä/–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π'. –ê–Ω–∞–ª–∏–∑ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω.")


def analyze_transcripts(target_date_str: str):
    """
    –ü—Ä–æ–≤–æ–¥–∏—Ç –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ
    –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –≤–∏–¥–µ JSON-—Ñ–∞–π–ª–æ–≤.

    Args:
        target_date_str (str): –î–∞—Ç–∞, –∑–∞ –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç—ã, –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–î–î.–ú–ú.–ì–ì–ì–ì".
    """
    transcripts_folder = Path("transcripts") / f"—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è_{target_date_str}"
    audio_calls_folder = Path("audio") / f"–∑–≤–æ–Ω–∫–∏_{target_date_str}"  # –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –∞—É–¥–∏–æ-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

    if not transcripts_folder.exists():
        print(f"–ü–∞–ø–∫–∞ —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: {transcripts_folder}. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑.")
        return

    print(f"–ù–∞—á–∏–Ω–∞–µ–º –∞–Ω–∞–ª–∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤ –∏–∑ –ø–∞–ø–∫–∏: {transcripts_folder}")

    for filename in os.listdir(transcripts_folder):
        if filename.endswith(".txt") and not filename.endswith("_raw.txt"):
            transcript_path = transcripts_folder / filename
            base_name = filename.replace(".txt", "")

            # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
            # –ü—Ä–∏–º–µ—Ä –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞: call123_79001234567.txt
            phone_number_match = re.search(r'call\d+_(\d+)', base_name)
            phone_number_from_filename = phone_number_match.group(1) if phone_number_match else None

            # –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å call_info.json –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è raw –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—á–∞–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            initial_category = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
            info_path = audio_calls_folder / f"{base_name}_call_info.json"
            if info_path.exists():
                try:
                    with open(info_path, "r", encoding="utf-8") as f:
                        call_info = json.load(f)
                        raw_call_data = call_info.get("raw", {})
                        initial_category = categorize_call_by_metadata(raw_call_data)
                except json.JSONDecodeError as e:
                    print(f"–û—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è JSON –¥–ª—è {info_path}: {e}")
                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ {info_path}: {e}")
            else:
                print(
                    f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –§–∞–π–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–≤–æ–Ω–∫–µ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è {base_name}: {info_path}. –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.")

            print(f"  –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º: {filename} (–ù–∞—á–∞–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: {initial_category})")
            # –ü–µ—Ä–µ–¥–∞–µ–º –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ analyze_single_transcript
            analyze_single_transcript(transcript_path, target_date_str, initial_category, phone_number_from_filename)

    print(f"–ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è {target_date_str} –∑–∞–≤–µ—Ä—à–µ–Ω.")


# –£–î–ê–õ–ï–ù–ò–ï: –§—É–Ω–∫—Ü–∏—è test_openai_api —É–¥–∞–ª–µ–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞.

# –¢–ï–°–¢–û–í–´–ô –ë–õ–û–ö, –ò–ú–ò–¢–ò–†–£–Æ–©–ò–ô –†–ê–ë–û–¢–£ –û–°–ù–û–í–ù–û–ì–û –ü–ê–ô–ü–õ–ê–ô–ù–ê
if __name__ == "__main__":
    TEST_TRANSCRIPT = """–ú–µ–Ω–µ–¥–∂–µ—Ä: –î–æ–±—Ä—ã–π –¥–µ–Ω—å. –≠—Ç–æ –º–∞–≥–∞–∑–∏–Ω ¬´–¢—Ä–æ–ø–∏–∫ –•–∞—É—Å¬ª. –ú–µ–Ω—è –∑–æ–≤—É—Ç –ù–∞—Å—Ç–∞—Å—å—è. –Ø —á–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?  
–ö–ª–∏–µ–Ω—Ç: –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –¥–µ–≤—É—à–∫–∞. –Ø —Å–µ–≥–æ–¥–Ω—è —Å–µ–π—á–∞—Å —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∞ –∑–∞–∫–∞–∑.  
–ú–µ–Ω–µ–¥–∂–µ—Ä: –£–≥—É.  
–ö–ª–∏–µ–Ω—Ç: –ò –ø—Ä–æ—Å–ø–µ–ª–∞ –±—ã –ø—Ä—è–º –¥–æ—Å—Ç–∞–≤–∫—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ. –°–∫–∞–∂–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?  
–ú–µ–Ω–µ–¥–∂–µ—Ä: –¢–∞–∫, —Å–µ–∫—É–Ω–¥—É. –ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –∫–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?  
–ö–ª–∏–µ–Ω—Ç: –ö–∞—Ä–∏–Ω–∞.  
–ú–µ–Ω–µ–¥–∂–µ—Ä: –£–≥—É. –ö–∞—Ä–∏–Ω–∞, –æ—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ. –¢–∞–∫, —Å–µ–π—á–∞—Å –ø–æ—Å–º–æ—Ç—Ä–∏–º –≤–∞—à –∑–∞–∫–∞–∑. –°–µ–∫—É–Ω–¥–æ—á–∫—É.  
–ö–ª–∏–µ–Ω—Ç: –£–≥—É.  """

    TEST_FILENAME = "test_call_12345_79001112233.txt"
    TEST_DATE_STR = datetime.today().strftime("%d.%m.%Y")

    # 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –ø–∞–ø–∫–∏ –∏ —Ñ–∞–π–ª–∞
    temp_transcripts_folder = Path("transcripts") / f"—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è_{TEST_DATE_STR}"
    os.makedirs(temp_transcripts_folder, exist_ok=True)
    temp_transcript_path = temp_transcripts_folder / TEST_FILENAME

    with open(temp_transcript_path, "w", encoding="utf-8") as f:
        f.write(TEST_TRANSCRIPT)

    # 2. –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞
    print("--- –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í–û–ì–û –ê–ù–ê–õ–ò–ó–ê ---")

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–æ–º–µ—Ä –∏ –Ω–∞—á–∞–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è —Ç–µ—Å—Ç–∞
    test_phone = "79001112233"
    test_initial_category = "–ó–∞–∫–∞–∑"  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä—É—á–Ω—É—é –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏, —á—Ç–æ —ç—Ç–æ –Ω–µ –∫–æ—Ä–æ—Ç–∫–∏–π –∑–≤–æ–Ω–æ–∫

    analyze_single_transcript(
        transcript_path=temp_transcript_path,
        target_folder_date_str=TEST_DATE_STR,
        initial_category=test_initial_category,
        phone_number=test_phone
    )

    # 3. –û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ (–ø–æ –∂–µ–ª–∞–Ω–∏—é, –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã)
    # temp_transcript_path.unlink()
    # temp_transcripts_folder.rmdir()

    print("--- –¢–ï–°–¢–û–í–´–ô –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù ---")